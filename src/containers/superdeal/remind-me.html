<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Remind me</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link href="../../css/mui.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="../../css/base.css" />
    <link rel="stylesheet" href="../../css/subpage.css"/>
    <style type="text/css">
        .mui-segmented-control.mui-segmented-control-inverted .mui-control-item.mui-active {
            color: #fff !important;
            border-color: #FFFFFF !important;
        }

        .mui-segmented-control.mui-segmented-control-inverted .mui-control-item.mui-active p {
            color: #FFFFFF !important;
        }

        .mui-segmented-control.mui-scroll-wrapper {
            height: 48px;
        }

        .product-text {
            height: 120px;
        }

        .product-size {
            margin-right: 10px
        }
    </style>
</head>


<body>

<header class="mui-bar mui-bar-nav">
    <span id="back_btn" class="mui-icon mui-icon-arrowleft mui-icon-bars mui-pull-left" onclick="history.go(-1)"></span>
    <h1 class="mui-title">Remind me</h1>
</header>

<div id="refreshContainer" class="mui-content mui-scroll-wrapper">
    <div class="mui-scroll">
        <div data-type="remind-tpl" class="mui-content">
            <!-- remind-tpl -->
        </div>
        <div id="move-togger"></div>
    </div>
</div>

<!-- off-canvas backdrop -->
<div class="mui-off-canvas-backdrop"></div>

<script src="../../js/common/api.js"></script>
<script src="../../js/common/jquery.min.js"></script>
<script src="../../js/common/mui.min.js"></script>
<script src="../../js/common/template/template.js"></script>
<script src="../../js/main.js"></script>
<script src="../../js/superdeals/reamind.js"></script>
<script type="text/javascript">
    template.helper('dateFormat', function (timestamp) {
        var date = new Date(new Number(timestamp));
        return date.format("MM/dd hh:mm");
    });
</script>
<script id="remind-tpl" type="text/html">
    {{each data as p i}}
    <div id="">
        <div class="padding-line44 bakc-fff font-weight font-color-9" data-endTime="{{beginTime}}">
            <span class="color-red">{{p.beginTime | dateFormat}}</span>
        </div>
        {{each p.superDealProduct as q i}}
        <ul class="mui-table-view border-t margin-b10">
            <li class="mui-table-view-cell">
                <p class="product-size mui-pull-left radius4 margin-t5">
                    <img src="{{q.mainImage}}">
                </p>
                <dl class="mui-media-body product-text relative">
                    <dt class="nospace font14">
                        {{q.name}}
                    </dt>
                    <dd>
                        <p class="font-weight color-red">TTD$ {{q.superDealPrice.toFixed(2)}} /{{p.unit}}</p>
                        <p class="line-through">TTD$ {{q.originalPrice.toFixed(2)}} /{{p.unit}}</p>
                    </dd>
                    <dd class="hidden">
                        <p class="mui-pull-left text-l font12">popularity：{{q.popularity}}</p>
                        <span class="cancle-reminder mui-pull-right text-r color-red" data-productid="{{q.superDealProductId}}">Cancle reminder</span>
                    </dd>
                </dl>
            </li>
        </ul>
        {{/each}}
    </div>
    {{/each}}
</script>
<script type="text/javascript">
    mui.init({
        pullRefresh : {
            container:"#refreshContainer",//待刷新区域标识，querySelector能定位的css选择器均可，比如：id、.class等
            up : {
                height:50,//可选.默认50.触发上拉加载拖动距离
                auto:false,//可选,默认false.自动上拉加载一次
                contentrefresh : "Loading...",//可选，正在加载状态时，上拉加载控件上显示的标题内容
                contentnomore:'-_- have nothing !!!',//可选，请求完毕若没有更多数据时显示的提醒内容；
                callback : function() {
                    var self = this; // 这里的this == mui('#refreshContainer').pullRefresh()
                    // 加载更多的内容
                    loadMore(this);
                } //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
            }
        }
    });
    var loadMore = function(pullRefresh) {
        // 加载更多的内容到列表中
        // TODO
        // 如果没有更多数据了，则关闭上拉加载
        pullRefresh.endPullupToRefresh(true);
        // 如果有更多数据，则继续
        pullRefresh.endPullupToRefresh(false);
    };

    mui('body').on('tap', 'a', function () {
        window.top.location.href = this.href;
    });

</script>
</body>

</html>
